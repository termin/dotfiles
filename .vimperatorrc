"2.2 (created: 2009/10/28 19:04:27)

" ----- notice -----
" set!はFirefoxの設定を変える
" setはvimperatorの設定

" ----- main options -----
set runtimepath=/Users/termin/.vimperator
source! /Users/termin/.vimperatorrc.local

" m Menubar
" T Toolbar
" B Bookmark bar
" n Tab number 
" N Tab number over image
" b Bottom scrollbar
" r Right scrollbar
" l Left scrollbar (l and r are mutually exclusive)
set guioptions=rbT


" ブラウザタイトルの変更
set titlestring=Vimperator
" ページ全体で検索語を強調表示
set hlsearch
" 検索語の大文字小文字を無視
" set ignorecase
"ビープ音を鳴らさずビジュアルベルを使用
set visualbell
"ビジュアルベルを無効化
hi Bell display: none;
" 新しいタブで開く
" all			All commands
" addons		:addo[ns] command
" downloads		:downl[oads] command
" extoptions	:exto[ptions] command
" help			:h[elp] command
" javascript	:javascript! or :js! command
" prefs			:pref[erences]! or :prefs! command
set newtab=all
" exモード時でインクリメント補完
set wildoptions=auto
" input要素にfocusを奪われないようにする
" set focuscontent
" Items which are completed at the :open prompts. Available items:
" default: slf
" s Search engines and keyword URLs 
" f Local files 
" l Firefox location bar entries (bookmarks and history sorted in an intelligent way) 
" b Bookmarks 
" h History 
" S Search engine suggestions 
" t Open tabs
set complete=slS
" リンク先の表示位置
" 0 Don’t show link destination
" 1 Show the link in the status line
" 2 Show the link in the command line
set showstatuslinks=2
"Awesomebarの補完対象にBookmarkletを追加、件数を50件に変更
" set! browser.urlbar.filter.javascript=false
" set! browser.urlbar.maxRichResults=50 
" HintのStyle
" hi Hint z-index:5000; font-family:monospace; font-size:14px; color:white; background-color:blue; border-color:ButtonShadow; border-width:0px; border-style:solid; padding:0px 1px 0px 1px; position:absolute;

" ----- Key Mappings -----
" <C-x>: The control or ctrl key.
" <A-x>: The alt key.
" <M-x>: The meta key, windows key, or command key
" <S-x>: The shift key.

" <M-A-Left>/<M-A-Right>かh/lでタブ移動
map <M-A-Left> <C-p>
map <M-A-Right> <C-n>
map h <C-p>
map l <C-n>
"<S-M-Left>/<S-M-Right>で現在のタブの位置変更
map <S-M-Left>  :tabmove! -1<CR>
map <S-M-Right> :tabmove! +1<CR>
" <M-f>でvimpによる検索/
map <M-f> /
" tumblrでtキーを使う為、Tで代用する
"map T :tabopen<Space>
" LDRizeのfキー対策
" map e gi
map e <M-i>
" URL中の数字を++/--
noremap ++ <C-a>
noremap -- <C-x>
" d キーでも直前にフォーカスしていたタブに戻る様にする
" 恐らく<M-w>にはTabMixPlusの設定が生きているが、dキー及び<C-w>にはそれが効かない・・・のかな...
noremap <C-w> <M-w>
map d <C-w>
" undo一覧から開く
map U :undo<Space>
map ,s :saves<CR>
nnoremap ,r :source ~/.vimperatorrc<CR>

" ----- Plugin Options  -----
"<C-Del>で検索語の強調表示をトグル(toggleHighlight.js)
"map <C-Del> :toggleHighlight<CR>
"<F2>でメニューバーをトグル(toggleToolbar-0.5.1.js)
"map <F2> :toggleToolbar<CR>
"<A-g>でGreasemonkeyをトグル(gmperator.js)
"map <A-g> :gmset!<CR>
"bではてブのコメントを表示(hatenabookmark_show.js 一部修正)
"map b :hbinfo<CR>

" copy.js
"<C-S-c>でタイトルとURLをコピー(copy.js)
map <M-S-c> :copy titleAndURL<CR>
map cp :copy<Space>
js <<EOM
liberator.globalVariables.copy_templates = [
  { label: 'titleAndURL',    value: '%TITLE%\n%URL%' },
  { label: 'title',          value: '%TITLE%', map: ',y' },
  { label: 'anchor',         value: '<a href="%URL%">%TITLE%</a>' },
  { label: 'selanchor',      value: '<a href="%URL%" title="%TITLE%">%SEL%</a>' },
  { label: 'htmlblockquote', value: '<blockquote cite="%URL%" title="%TITLE%">%HTMLSEL%</blockquote>' },
  { label: 'hatena',		 value: '[%URL%:title]'},
  { label: 'ASIN',   value: 'copy ASIN code from Amazon', custom: function(){return content.document.getElementById('ASIN').value;} }
];
EOM

"<S-s>でBloglinesに登録(commandBookmarklet.js)
"map S :Sub<CR>

" feedSomekeys_2.js
autocmd LocationChange .* :fmapc
" LDR/Fastladder/OpenFL
" れとれとさんrcより
" autocmd LocationChange ^http://(reader\.livedoor\.com|fastladder\.com|0\.0\.0\.0\:3000)/reader/ :fmap j k s a p v c z Z b i,ie r < > o,vj J,<Space> K,<S-Space> q w g u T
" autocmd LocationChange fastladder\\.com/reader :fmap j k s a r p o v c <Space> <S-Space> < > T
autocmd LocationChange ^http://reader\\.livedoor\\.com/reader :fmap! j k s a r p o f v c <Space> <S-Space> < > T
" Tumblr (user : ReblogCommand, TumblrTagCommand)
autocmd LocationChange ^http://.*\\.tumblr\\.com/ :fmap! i,t h g
" Gmail
autocmd LocationChange ^https?://mail\\.google\\.com/mail :fmap! -depth 4 c / j k n p o u e x s r a # [ ] z ? gi gs gt gd ga gc
" Google Calendar
autocmd LocationChange ^http://www\\.google\\.com/calendar/ :fmap! -vkey -event keydown j k t a d w m x c e <;Del> / + q s ?
" RememberTheMilk
autocmd LocationChange ^http://www\\.rememberthemilk\\.com/ :fmap r t i o p a s d f g h j k l z x c v b n m 0 1 2 3 4
" はてなブックマーク
autocmd LocationChange ^http://b\\.hatena\\.ne\\.jp(?!entry|articles|guide) :fmap! j k o e a

" removetabs.js
" 左側にあるタブを閉じる
noremap <C-S-Left> :removetabsleft
" 右側にあるタブを閉じる
noremap <C-S-Right> :removetabsright
" tabsort.js
command! urlsort tabsort -t=url
" _smooziee.js
" let g:smooziee_scroll_amount="10"
" let g:smooziee_scroll_interval="50"

" char-hints-mod2.js
" let g:hintchars="asdfjkl"
let g:hintsio="iO"
" let g:hintlabeling=""

" toggler.js
" :toggle go で setting commands配列の次を実行する
" 元々は go: ["set go=","set go=rbT","set go=rb"],
" なんでgo= と記述されているのか分からない.
js <<EOM
liberator.globalVariables.toggler = {
  //  name: [ setting commands ]],
  // ツールバー
  go: ["set go=rbT","set go=rb"],
  // サイドバー
  sb: ["sbclose","sbar Console"],
  go_and_sb: [
    ["set go=","sbclose"],
    ["set go=mTb","sbar Console"]
  ],
  //...
};
EOM

map <F2> :toggle go<CR>
map <F3> :toggle sb<CR>
" 再考したい
noremap ,1 :set go=rbT<CR>
noremap ,2 :set go=rb<CR>
" travian のみでツールバーを表示する
autocmd LocationChange .* set go=rb
autocmd LocationChange ^http://s4.travian.jp/ set go=rbT

" はてなブックマーク拡張( http://subtech.g.hatena.ne.jp/secondlife/20090402/1238655382 )
javascript if (typeof hBookmark != 'undefined') liberator.loadScript('chrome://hatenabookmark/content/vimperator/plugin/hatenabookmark.js', {__proto__: this});

javascript <<EOF
// キーボードショートカットの指定
// 空(null)を指定すれば hints や nnoremap を上書きしなくなる
liberator.globalVariables.hBookmark_shortcuts = {
    hintsAdd     : 'c',
    hintsComment : 'C',
    add          : [''],
    comment      : [''],
};
// コマンドの設定
// 以下、はてブ拡張 ver. 1.2.4a1 以降で有効
/*
liberator.globalVariables.hBookmark_commands = {
        hbsearch             : 'hb[search]',
        hbsearch_tab         : 'hbt[absearch]',
        hbsearch_comment     : 'hbc[omment]',
        hbsearch_comment_tab : 'hbtc[omment]',
        hbsearch_url         : 'hbu[rl]',
        hbsearch_url_tab     : 'hbtu[rl]',
        hbsearch_title       : 'hbti[tle]',
        hbsearch_title_tab   : 'hbtti[tle]',
};
*/

// :hb! url 等の bang(!) 付きで開いた場合の挙動。
// 標準ははてブエントリーページを開く entryPage が設定されている。
// 他に新規タブで開く openNewTab がある。
// また、文字列ではなく自分で定義した関数をセットすることもできる。
liberator.globalVariables.hBookmark_bangFunction = 'entryPage';

// 検索時の wait(ms)
liberator.globalVariables.hBookmark_search_interval = 1000;
// 一度に検索する limit
liberator.globalVariables.hBookmark_search_limit = 10;
// 検索時の表示の最大件数。この件数に達するまで検索し続ける。
liberator.globalVariables.hBookmark_search_max_limit = 100;

EOF

" autocmd VimperatorEnter .* :set complete+=H
" はてブ検索
noremap C :hbt<Space>
" noremap cx :
" コメントのみ対象
noremap cc :hbtc<Space>
" titleのみ対象
noremap ct :hbtti<Space>
" urlのみ対象
" noremap cu :hbu<Space>
" entry_pageを表示する( exopen.jsを用いる )
javascript <<EOM
liberator.globalVariables.exopen_templates = [
{
  label: 'hatenaep',
  value: 'http://b.hatena.ne.jp/entry/%URL%',
  description: 'open hatena bookmark entrypage',
  newtab: true
}/*, {
  label: 'coderepos',
  value: 'http://coderepos.org/share/browser/lang/javascript/vimperator-plugins/trunk/',
  description: 'open coderepos vimperator-plugin page',
  newtab: true
} */
];
EOM
" label:
"   テンプレート名。コマンドの引数で指定してください。
" value:
"   OpenするURL
" custom:
"   関数か配列で指定してください。
"   関数の場合、return された文字列をオープンします。
"   配列の場合、value で指定された文字列を置換します。(条件→Array[0]、置換文字列→Array[1])
" description:
"   補完時に表示する説明文。
" newtab:
"   新規タブで開く場合は true を指定してください。
" escape:
"   URLエンコードする場合、true を指定してください。
 
noremap <C-S-x> :exopen hatenaep<CR>

" ----- その他 -----
" フィードボタンをステータスラインに移動
javascript <<EOM
(function () {
    var feedButton = document.getElementById('feed-button');
        feedButton.parentNode.removeChild(feedButton);
    var feedPanel  = document.createElement('statusbarpanel');
        feedPanel.setAttribute('id', 'feed-panel-clone');
        feedPanel.appendChild(feedButton.cloneNode(true));
    document.getElementById('status-bar').insertBefore(
        feedPanel,
        document.getElementById('security-button')
    );
})();
EOM


" vim: set ft=vimperator:
